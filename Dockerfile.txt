FROM python:3.10-slim

# Install dependencies
RUN pip install --no-cache-dir fastapi uvicorn transformers torch

# Create HF cache
RUN mkdir -p /tmp/hf_cache && chmod 777 /tmp/hf_cache
ENV HF_HOME=/tmp/hf_cache

WORKDIR /code

# Copy app code
COPY app.py .

# Expose API port
EXPOSE 7860

# Run the FastAPI app
CMD ["python", "app.py"]